{% extends "templates/web.html" %}

{% block page_content %}
<div class="portal-wrapper">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>{{ _("Members") }}</h1>
        <button class="btn btn-primary" onclick="newMember()">{{ _("New Member") }}</button>
    </div>

    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>{{ _("Name") }}</th>
                    <th>{{ _("Email") }}</th>
                    <th>{{ _("Phone") }}</th>
                    <th>{{ _("Status") }}</th>
                    <th>{{ _("Actions") }}</th>
                </tr>
            </thead>
            <tbody>
                {% for member in members %}
                <tr>
                    <td>{{ member.full_name }}</td>
                    <td>{{ member.email or '' }}</td>
                    <td>{{ member.phone or '' }}</td>
                    <td>
                        <span class="badge {% if member.status == 'Active' %}badge-success{% else %}badge-warning{% endif %}">
                            {{ member.status }}
                        </span>
                    </td>
                    <td>
                        <div class="btn-group">
                            <button class="btn btn-sm btn-info" onclick="editMember('{{ member.name }}')">
                                {{ _("Edit") }}
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteMember('{{ member.name }}')">
                                {{ _("Delete") }}
                            </button>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block script %}
<script>
function newMember() {
    frappe.new_doc('Member', true);
}

function editMember(name) {
    frappe.set_route('Form', 'Member', name);
}

function deleteMember(name) {
    frappe.confirm(
        __('Are you sure you want to delete this member?'),
        function() {
            frappe.call({
                method: 'umt_nfe.umt_nfe.doctype.member.member.delete_member',
                args: { name: name },
                callback: function(r) {
                    if (!r.exc) {
                        frappe.show_alert({
                            message: __('Member deleted successfully'),
                            indicator: 'green'
                        });
                        location.reload();
                    }
                }
            });
        }
    );
}
</script>
{% endblock %}

{% block style %}
<style>
.portal-wrapper {
    padding: 2rem;
}
.badge-success {
    background-color: #28a745;
    color: white;
}
.badge-warning {
    background-color: #ffc107;
    color: black;
}
.btn-group {
    gap: 0.5rem;
}
</style>
{% endblock %}
